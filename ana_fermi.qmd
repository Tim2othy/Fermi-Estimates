---
title: "exploring_estimateates"
format: html
editor: visual
---

# Preliminaries

```{r}
library(tidyverse)
library(readxl)
```

```{r}
Fermi_Data_Original <- read_excel("Fermi-Data.xlsx")
my_data <- data.frame(Fermi_Data_Original)

options(scipen = 999)
```

Renaming collumns

```{r}
my_data <- my_data %>%
    rename(
        Answers = Correct.answers,
        Timothy_estimate = Timothy.Answer,
        Timothy_average = Timothy.s.guess,
        Markus_estimate = Markus.Answer,
        Markus_average = Markus.s.guess,
        Marvin_estimate = Marvin.Answer,
        Marvin_average = Marvin.s.guess,
        Adrian_estimate = Adrian.Answer,
        Adrian_average = Adrian.s.guess,
    )
```

Function to calculate log/exp error

```{r}
calc_error <- function(actual, forecast) {
    abs(log10(max(0.01, actual)) - log10(max(0.01, forecast)))
}
```

Add columns for the two mean values

```{r}
# Calculate mean forecast and mean guess
my_data$Mean_of_estimates <- rowMeans(my_data[, c("Timothy_estimate", "Markus_estimate", "Marvin_estimate", "Adrian_estimate")], na.rm = TRUE)
my_data$Mean_of_averages <- rowMeans(my_data[, c("Timothy_average", "Markus_average", "Marvin_average", "Adrian_average")], na.rm = TRUE)
```

create results dataframe

```{r}
# Create results dataframe with errors
people <- c("Timothy", "Markus", "Marvin", "Adrian", "Mean")
types <- c("_estimate", "_average")

results <- data.frame(matrix(ncol = 10, nrow = 10))
names(results) <- paste0(rep(people, each = 2), rep(types, times = 5), "_error")


```


```{r}
for (i in 1:10) {
    for (j in 1:10) {
        results[i, j] <- calc_error(my_data$Answers[i], my_data[i, j + 2])
    }
}
```



```{r}
for (i in 1:10) {
    sum_row_estimates <- sum(results[i, c(1, 3, 5, 7)], na.rm = TRUE)
    sum_row_averages <- sum(results[i, c(2, 4, 6, 8)], na.rm = TRUE)
    for (j in c(1, 3, 5, 7, 9)) {
        results[i, j] <- results[i, j] / sum_row_estimates
    }
    for (j in c(2, 4, 6, 8, 10)) {
        results[i, j] <- results[i, j] / sum_row_averages
    }
}

```



```{r}
# Add empty column to left of results
new_col <- rep(NA, nrow(results))
results <- cbind(new_col, results)
names(results)[1] <- "Row_description"
results$Row_description <- my_data$Question
```

```{r}
# Add a new row with column sums
for (j in 2:11) {
    results[11, j] <- sum(results[1:10, j])
}

results[11, 1] <- "Total normalized error"
```
